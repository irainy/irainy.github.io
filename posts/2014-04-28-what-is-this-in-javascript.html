<!DOCTYPE html>
<html lang="zh-cn">
<head>

<meta name="description" contents="J"/>
<meta name="description" contents="a"/>
<meta name="description" contents="v"/>
<meta name="description" contents="a"/>
<meta name="description" contents="s"/>
<meta name="description" contents="c"/>
<meta name="description" contents="r"/>
<meta name="description" contents="i"/>
<meta name="description" contents="p"/>
<meta name="description" contents="t"/>
<meta name="description" contents=" "/>
<meta name="description" contents="语"/>
<meta name="description" contents="言"/>
<meta name="description" contents="中"/>
<meta name="description" contents=" "/>
<meta name="description" contents="t"/>
<meta name="description" contents="h"/>
<meta name="description" contents="i"/>
<meta name="description" contents="s"/>
<meta name="description" contents=" "/>
<meta name="description" contents="关"/>
<meta name="description" contents="键"/>
<meta name="description" contents="字"/>
<meta name="description" contents="的"/>
<meta name="description" contents="含"/>
<meta name="description" contents="义"/>
<meta name="description" contents="及"/>
<meta name="description" contents="应"/>
<meta name="description" contents="用"/>

<meta name="tags" contents="Javascript"/>
    <title>rainy</title>
    <meta charset="utf-8"/>
    <!-- Bootstrap core css -->
    <link rel="stylesheet" href="/theme/css/bootstrap-paper.min.css">
    <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/css/style.css">

    <!-- Jquery before bootstrap.js -->
    <script src="/theme/js/jquery.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>


</head>

<body id="index">
<div class="container main-container">
    <div class="row main-row">
        <section id="side-bar" class="col-md-4">
            <ul class="name-card">
                <li>
                    <a href="https://github.com/rainy-im" title="My Github">
                        <img class="avatar" src="https://avatars0.githubusercontent.com/u/3953966?v=3&s=460"/>
                    </a>
                </li>
                <li class="name-card-name"><b>rainy.im</b></li>
                <li class="name-card-slogan"><i>I thought, therefore I write.</i></li>
                <li class="divider"></li>
            </ul>
            <form class="side-search" onsubmit="return search()">
                <input id="search-query" type="text" class="form-control" placeholder="Search">
            </form>
            <ul class="nav nav-sidebar">
                <li><a href="/">Home</a></li>
                <li><a href="/archives.html">Archive</a></li>
                <li><a href="/categories.html">Category</a></li>
                <li><a href="/tags.html">Tags</a></li>
                <li><a href="">RSS</a></li>
            </ul>
            <ul class="sns">
                <li>
                    <a href="mailto:sniky.hack@gmail.com" title="email" class="fa fa-send"></a>
                </li>
                <li>
                    <a href="http://weibo.com/myaplysia" title="Weibo" alt="Weibo" class="fa fa-weibo"></a>
                </li>
                <li>
                    <a href="https://github.com/rainy-im" title="Github" alt="Github" class="fa fa-github"></a>
                </li>
            </ul>
        </section>
        <!--left side-->
        <section class="col-md-8">
<section id="content" class="body col-md-8">
    <ul class="post-info breadcrumb">
        <li><a href="/">Home</a></li>
        <li>
            <a href="/category/yu-yan.html" title="语言" alt="语言">
                语言
            </a>
        </li>
        <li class="active">
            一 28 四月 2014
        </li>
    </ul>
    <!-- /.post-info -->

    <header>
        <h4 class="entry-title">
            <a href="http://defsniky.com/posts/2014-04-28-what-is-this-in-javascript.html" rel="bookmark"
               title="Permalink to What's this in Javascript">What's this in Javascript</a>
        </h4>
    </header>

    <div class="entry-content">
        <p><a href="/images/ouroboros.png" data-title="咬尾蛇" data-lightbox="example-set">
<img alt="咬尾蛇" src="/images/ouroboros.png" title="咬尾蛇" />
</a></p>
<p>this是Javascript中的一个关键字，由于Javascript并没有“类”(class)的概念，致使这里的this与其它面向对象的语言中诸如<code>this</code>、<code>self</code>等关键字的含义存在一定的差异，而容易造成的误解。在面向对象的语言中<code>this</code>指向类的实例对象，在实例化之后通过<code>this</code>调用的属性或方法会被自动指向类作用域中的属性或方法，同样的，Javascript中的<code>this</code>也用于指向特定的作用域，只不过因为JavaScript中没有类作用域的概念，而是采用作用域链(Scope Chain)的方式管理上下文，因而需要根据不同的应用场景判定<code>this</code>所指向的内容。</p>
<p>首先，在Chrome Console或Node中直接输入<code>this</code>，得到的是<code>Window</code>对象或Node中的全局对象（以下以Console为例，因为突然发现<code>console.log()</code>跟<code>alert()</code>还是有差别的:P），这时<code>this</code>指向全局变量（或者说它是全局变量的指针），这时的<code>this</code>默认是隐含的：</p>
<div class="highlight"><pre><span class="c1">//在全局环境中</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">//等价于this.x = 1</span>
<span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>      <span class="c1">//输出1</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>           <span class="c1">//输出1</span>
</pre></div>


<p>当<code>this</code>在函数中被使用的时候，类似一个递归的过程，<code>this</code>指向调用该函数的（全局或对象）作用域，即只要看“包裹”函数的作用域即可：</p>
<div class="highlight"><pre><span class="c1">//新的环境</span>
<span class="kd">function</span> <span class="nx">test</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">alert</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">test</span><span class="p">();</span> <span class="c1">//undefined, 因为此时调用test()的是全局作用域，而全局作用域中没有定义x</span>
<span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="mi">1</span><span class="p">};</span>
<span class="nx">obj</span><span class="p">.</span><span class="nx">test</span> <span class="o">=</span> <span class="nx">test</span><span class="p">;</span>
<span class="nx">obj</span><span class="p">.</span><span class="nx">test</span><span class="p">();</span> <span class="c1">//1, 因为调用test()的是obj作用域，而obj.x = 1，在这里其功能已经类似于面向对象的this指针了</span>
</pre></div>


<p>另外一种比较特殊的情况是，当使用<code>new</code>关键字构造新的对象时，被<code>new</code>的函数就不是普通的函数了，它变成了一个“构造函数”，此时会自动给它“包裹”上一层对象作用域：</p>
<div class="highlight"><pre><span class="c1">//新的环境</span>
<span class="kd">function</span> <span class="nx">Person</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;rainy&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">rainy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Person</span><span class="p">();</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">rainy</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span> <span class="c1">// &#39;rainy&#39;, 不再是undefined</span>
</pre></div>


<hr />
<p>好久没有更新，关于<code>this</code>在看《JavaScript高级程序设计》时就想整理一下，一直拖到现在。Javascript中的<code>this</code>容易被混淆更多的是因为其<strong>作用域链</strong>与<strong>原型链</strong>的概念与一般语言尤其是面向对象语言的作用域规则相差较多；而<code>this</code>关键字本身有趣的地方在于它存在于对象或函数内部却从外向内地指向了对象或函数本身，就像一条首尾相接的“衔尾蛇”，衔尾蛇既反映荣格所说的人类心理的<strong>原型</strong>，又与道长神秘兮兮地说过的人类意识<strong>自指</strong>的特性不谋而合，哈哈，又见心理学。</p>
    </div>
    <!-- /.entry-content -->
</section>
        </section>
        <!--main content-->
    </div>
    <footer id="contentinfo" class="row">
        <address id="about" class="col-md-12">
            Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
            Theme based on <a href="http://bootswatch.com/paper">Bootstrap paper</a>.
        </address>
    </footer>
</div>

<!-- /#contentinfo -->
<script type="text/javascript" src="/theme/js/main.js"></script>
</body>
</html>