<!DOCTYPE html>
<html lang="zh-cn">
<head>

<meta name="description" contents="用"/>
<meta name="description" contents="可"/>
<meta name="description" contents="视"/>
<meta name="description" contents="化"/>
<meta name="description" contents="网"/>
<meta name="description" contents="络"/>
<meta name="description" contents="的"/>
<meta name="description" contents="形"/>
<meta name="description" contents="式"/>
<meta name="description" contents="展"/>
<meta name="description" contents="示"/>
<meta name="description" contents="标"/>
<meta name="description" contents="签"/>
<meta name="description" contents="云"/>
<meta name="description" contents="，"/>
<meta name="description" contents="采"/>
<meta name="description" contents="用"/>
<meta name="description" contents="了"/>
<meta name="description" contents="s"/>
<meta name="description" contents="p"/>
<meta name="description" contents="r"/>
<meta name="description" contents="i"/>
<meta name="description" contents="n"/>
<meta name="description" contents="g"/>
<meta name="description" contents="y"/>
<meta name="description" contents="，"/>
<meta name="description" contents="自"/>
<meta name="description" contents="制"/>
<meta name="description" contents="了"/>
<meta name="description" contents="P"/>
<meta name="description" contents="e"/>
<meta name="description" contents="l"/>
<meta name="description" contents="i"/>
<meta name="description" contents="c"/>
<meta name="description" contents="a"/>
<meta name="description" contents="n"/>
<meta name="description" contents=" "/>
<meta name="description" contents="p"/>
<meta name="description" contents="l"/>
<meta name="description" contents="u"/>
<meta name="description" contents="g"/>
<meta name="description" contents="i"/>
<meta name="description" contents="n"/>

<meta name="tags" contents="FUN"/>
<meta name="tags" contents="Javascript"/>
    <title>rainy</title>
    <meta charset="utf-8"/>
    <!-- Bootstrap core css -->
    <link rel="stylesheet" href="/theme/css/bootstrap-paper.min.css">
    <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/css/style.css">

    <!-- Jquery before bootstrap.js -->
    <script src="/theme/js/jquery.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>


</head>

<body id="index">
<div class="container main-container">
    <div class="row main-row">
        <section id="side-bar" class="col-md-4">
            <ul class="name-card">
                <li>
                    <a href="https://github.com/rainy-im" title="My Github">
                        <img class="avatar" src="https://avatars0.githubusercontent.com/u/3953966?v=3&s=460"/>
                    </a>
                </li>
                <li class="name-card-name"><b>rainy.im</b></li>
                <li class="name-card-slogan"><i>I thought, therefore I write.</i></li>
                <li class="divider"></li>
            </ul>
            <form class="side-search" onsubmit="return search()">
                <input id="search-query" type="text" class="form-control" placeholder="Search">
            </form>
            <ul class="nav nav-sidebar">
                <li><a href="/">Home</a></li>
                <li><a href="/archives.html">Archive</a></li>
                <li><a href="/categories.html">Category</a></li>
                <li><a href="/tags.html">Tags</a></li>
                <li><a href="">RSS</a></li>
            </ul>
            <ul class="sns">
                <li>
                    <a href="mailto:sniky.hack@gmail.com" title="email" class="fa fa-send"></a>
                </li>
                <li>
                    <a href="http://weibo.com/myaplysia" title="Weibo" alt="Weibo" class="fa fa-weibo"></a>
                </li>
                <li>
                    <a href="https://github.com/rainy-im" title="Github" alt="Github" class="fa fa-github"></a>
                </li>
            </ul>
        </section>
        <!--left side-->
        <section class="col-md-8">
<section id="content" class="body col-md-8">
    <ul class="post-info breadcrumb">
        <li><a href="/">Home</a></li>
        <li>
            <a href="/category/qu-wei.html" title="趣味" alt="趣味">
                趣味
            </a>
        </li>
        <li class="active">
            日 18 五月 2014
        </li>
    </ul>
    <!-- /.post-info -->

    <header>
        <h4 class="entry-title">
            <a href="http://defsniky.com/posts/2014-05-18-tag-cloud-network-visualization.html" rel="bookmark"
               title="Permalink to 做一个可视化网络的标签云">做一个可视化网络的标签云</a>
        </h4>
    </header>

    <div class="entry-content">
        <p>想要制作一个标签云：每一个标签(Tag)都像是一个topic，不同的topic之间通过文章联系起来，即不同的topic出现在同一篇文章中就形成一个更大的主题，因此自然而然地想到用网络的形式呈现，先看一下<a href="/tags.html">Demo</a>。</p>
<p><a href="/images/network.png" data-title="Network" data-lightbox="example-set">
<img alt="network" src="/images/network.png" />
</a></p>
<p>首先想要用 <code>Javascript</code> 实现可视化网络的话要选一个可视化工具库，最先想到的是<a href="http://d3js.org/">D3</a>，但后来发现用起来并不顺利，最后选用了一个小巧的<a href="http://getspringy.com/">Springy.js</a>，它包含两个部分，一是计算网络属性<code>Node &amp; Edge</code>等(<a href="https://github.com/dhotson/springy/blob/master/springy.js">springy.js</a>)，另一个基于 HTML5 的 Canvas 对网络进行绘制(<a href="https://github.com/dhotson/springy/blob/master/springyui.js">springyui.js</a>)。接下来要获取标签的统计以及标签之间的联系，因为我是用<a href="http://blog.getpelican.com/">Pelican</a>生成网站的，因此就想要自己写一个 plugin 在生成网站的时候统计文章标签的情况(<a href="http://git.oschina.net/sniky/pelican-blog/blob/master/plugins/tagsnet/tagsnet.py">代码</a>)，其中关于网络的 <code>Node &amp; Edge</code> 数据格式部分如下：</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">Node</span><span class="p">(</span><span class="n">ID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Name</span> <span class="o">=</span> <span class="s">&#39;None&#39;</span><span class="p">,</span> <span class="n">Value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Url</span> <span class="o">=</span> <span class="s">&#39;Url&#39;</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">{</span><span class="s">&#39;ID&#39;</span><span class="p">:</span> <span class="n">ID</span><span class="p">,</span> <span class="s">&#39;Name&#39;</span><span class="p">:</span> <span class="n">Name</span><span class="p">,</span> <span class="s">&#39;Value&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">,</span> <span class="s">&#39;Url&#39;</span><span class="p">:</span> <span class="n">Url</span><span class="p">}</span>
<span class="k">def</span> <span class="nf">Link</span><span class="p">(</span><span class="n">Src</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Tar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">{</span><span class="s">&#39;Src&#39;</span><span class="p">:</span> <span class="n">Src</span><span class="p">,</span> <span class="s">&#39;Tar&#39;</span><span class="p">:</span> <span class="n">Tar</span><span class="p">,</span> <span class="s">&#39;Value&#39;</span><span class="p">:</span> <span class="n">Value</span><span class="p">}</span>
</pre></div>


<p>接下来在页面中用<code>Springy</code>生成网络，其中<code>addNodes</code> 与 <code>addEdges</code>方法为适应上面生成的统计数据而进行了调整(<a href="http://git.oschina.net/sniky/pelican-blog/blob/master/themes/theme-by-rainy/static/js/springy.js#L87">addNodes</a>, <a href="http://git.oschina.net/sniky/pelican-blog/blob/master/themes/theme-by-rainy/static/js/springy.js#L140">addEdges</a>)，同时为<code>Node.data</code>添加了<code>ondoubleclick</code>的属性使标签在双击条件下跳转，正常的拖拽、选中不会产生跳转：</p>
<div class="highlight"><pre><span class="kd">var</span> <span class="nx">graph</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Springy</span><span class="p">.</span><span class="nx">Graph</span><span class="p">();</span>
<span class="nx">graph</span><span class="p">.</span><span class="nx">addNodes</span><span class="p">(</span><span class="nx">Network</span><span class="p">[</span><span class="s1">&#39;nodes&#39;</span><span class="p">]);</span>
<span class="nx">graph</span><span class="p">.</span><span class="nx">addEdges</span><span class="p">(</span><span class="nx">Network</span><span class="p">[</span><span class="s1">&#39;links&#39;</span><span class="p">]);</span>
<span class="nx">jQuery</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">springy</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">springy</span> <span class="o">=</span> <span class="nx">jQuery</span><span class="p">(</span><span class="s1">&#39;#tagsnet&#39;</span><span class="p">).</span><span class="nx">springy</span><span class="p">({</span>
        <span class="nx">graph</span><span class="o">:</span> <span class="nx">graph</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
    </div>
    <!-- /.entry-content -->
</section>
        </section>
        <!--main content-->
    </div>
    <footer id="contentinfo" class="row">
        <address id="about" class="col-md-12">
            Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
            Theme based on <a href="http://bootswatch.com/paper">Bootstrap paper</a>.
        </address>
    </footer>
</div>

<!-- /#contentinfo -->
<script type="text/javascript" src="/theme/js/main.js"></script>
</body>
</html>